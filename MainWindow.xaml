<Window x:Class="MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Streckenbremstafel"
        mc:Ignorable="d"
        Title="Streckenbremstafeln" Height="800" Width="800" WindowState="Maximized" Loaded="Window_Loaded" FontSize="16">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="5"/>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="5"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <Menu VerticalAlignment="Top">
            <MenuItem Header="_Datei">
                <MenuItem Header="Daten neu einlesen" Name="BTN_Laden" Click="BTN_Laden_Click"/>
                <MenuItem Header="Export als XLS" Name="BTN_Export_XLS" Click="BTN_Export_XLS_Click"/>
                <Separator/>
                <MenuItem Header="Editieren" Name="BTN_Edit" Click="BTN_Edit_Click"/>
                <Separator/>
                <MenuItem Header="Beenden" Name="BTN_Beenden" Click="BTN_Beenden_Click"/>
            </MenuItem>
        </Menu>
        
        <Grid Grid.Row="1" Grid.Column="0">
            <StackPanel Grid.Row="1">
                <!--<TextBlock Text="Start:" Margin="10,0,0,0"/>
                <ComboBox Name="CB_Start" DisplayMemberPath="AnzeigeText" MinWidth="200" Margin="10,0,0,0" DropDownClosed="CB_Start_DropDownClosed"/>
                <TextBlock Text="Ziel:" Margin="10,0,0,0"/>
                <ComboBox Name="CB_Ziel" DisplayMemberPath="AnzeigeText" MinWidth="200" Margin="10,0,0,0" DropDownClosed="CB_Ziel_DropDownClosed"/>-->
                <Button Content="Auswahl hinzufügen" Background="LightGreen" Name="BTN_Hinzufuegen" Click="BTN_Hinzufuegen_Click" Margin="10,5,0,0"/>
                <Button Content="Löschen" Background="Orange" Name="BTN_Löschen" Click="BTN_Löschen_Click" Margin="10,5,0,0"/>
                <Button Content="Berechnen" Name="BTN_Brechnen" Click="BTN_Brechnen_Click" Margin="10,5,0,0"/>
                <ListView Name="LV_LaufwegTemp" FontSize="12" Margin="10" Grid.Row="1" ItemsSource="{Binding LaufwegTemp}">
                    <ListView.ItemContainerStyle>
                        <Style TargetType="ListViewItem">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Ausgeben}" Value="False">
                                    <Setter Property="Background" Value="LightGray"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ListView.ItemContainerStyle>
                    <ListView.View>

                        <GridView>
                            <GridViewColumn Header="Bst" DisplayMemberBinding="{Binding Betriebsstelle}" Width="80"/>
                            <GridViewColumn Header="Signal" DisplayMemberBinding="{Binding Signalbezeichnung}" Width="80"/>
                            <GridViewColumn Header="Typ" DisplayMemberBinding="{Binding Typ}" Width="100"/>
                            <GridViewColumn Header="km" DisplayMemberBinding="{Binding km}" Width="80"/>
                            <GridViewColumn Header="V" DisplayMemberBinding="{Binding Geschwindigkeit}" Width="80"/>
                            <GridViewColumn Header="V Soll" Width="80">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <ComboBox ItemsSource="{Binding VerfuegbareGeschwindigkeiten}" 
                                  SelectedItem="{Binding Geschwindigkeit_Soll, Mode=TwoWay}" 
                                  MinWidth="60"/>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>
                        </GridView>
                    </ListView.View>
                </ListView>
            </StackPanel>
        </Grid>
        <GridSplitter Grid.Row="1" Grid.Column="1" Width="5" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="Gray" ShowsPreview="True"/>
        <Grid Grid.Row="1" Grid.Column="2" >
            <ScrollViewer>
                <Grid>
                    <StackPanel>
                        <TextBlock Text="Zugdaten:" FontWeight="Bold" Margin="10,0,0,0"/>
                        <TextBlock Text="Datum:" Margin="5,2,0,0"/>
                        <DatePicker Name="DP_Datum" Margin="5,2,0,0"/>
                        <TextBlock Text="Abfahrt:" Margin="5,2,0,0"/>
                        <TextBox Name="TB_Abfahrt" Margin="5,2,0,0"/>
                        <TextBlock Text="Zugnummer:" Margin="5,2,0,0"/>
                        <TextBox Name="TB_Zugnummer" Margin="5,2,0,0"/>
                        <TextBlock Text="Bremsstellung:" Margin="5,2,0,0"/>
                        <ComboBox Name="CB_Bremsstellung" Margin="5,2,0,0">
                            <ComboBoxItem Content="G"/>
                            <ComboBoxItem Content="P"/>
                        </ComboBox>
                        <TextBlock Text="Vorhandene BrH:" Margin="5,2,0,0"/>
                        <TextBox Name="TB_Mbr" Margin="5,2,0,0"/>

                        <TextBlock Text="Länge:" Margin="5,2,0,0"/>
                        <TextBox Name="TB_Laenge" Margin="5,2,0,0"/>
                        <TextBlock Text="Gewicht:" Margin="5,2,0,0"/>
                        <TextBox Name="TB_Gewicht" Margin="5,2,0,0"/>
                        <TextBlock Text="Zugbildung:" Margin="5,2,0,0"/>
                        <TextBox Name="TB_Fahrzeuge" Margin="5,2,0,0"/>
                    </StackPanel>
                </Grid>
            </ScrollViewer>
        </Grid>
        <GridSplitter Grid.Row="1" Grid.Column="3" Width="5" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="Gray" ShowsPreview="True"/>
        <StackPanel Grid.Row="1" Grid.Column="4">
            <ListView Name="LV_Laufweg" FontSize="12" Margin="10" Grid.Row="1" ItemsSource="{Binding Laufweg}">
                <ListView.ItemContainerStyle>
                    <Style TargetType="ListViewItem">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding Ausgeben}" Value="False">
                                <Setter Property="Background" Value="LightGray"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </ListView.ItemContainerStyle>
                <ListView.View>
                    
                    <GridView>
                        <GridViewColumn Header="Betriebsstelle" DisplayMemberBinding="{Binding Betriebsstelle}" Width="120"/>
                        <GridViewColumn Header="Signal" DisplayMemberBinding="{Binding Signalbezeichnung}" Width="80"/>
                        <GridViewColumn Header="Typ" DisplayMemberBinding="{Binding Typ}" Width="100"/>
                        <GridViewColumn Header="km" DisplayMemberBinding="{Binding km}" Width="80"/>
                        <GridViewColumn Header="V" DisplayMemberBinding="{Binding Geschwindigkeit}" Width="80"/>
                        <GridViewColumn Header="V Soll" Width="80">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <ComboBox ItemsSource="{Binding VerfuegbareGeschwindigkeiten}" 
                                              SelectedItem="{Binding Geschwindigkeit_Soll, Mode=TwoWay}" 
                                              MinWidth="60"/>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>
                        <GridViewColumn Header="Ausgabe" DisplayMemberBinding="{Binding Ausgeben}" Width="80"/>
                        <GridViewColumn Header="Ankunft" DisplayMemberBinding="{Binding S_Ankunft}" Width="80"/>
                        <GridViewColumn Header="Abfahrt" DisplayMemberBinding="{Binding S_Abfahrt}" Width="80"/>
                        <GridViewColumn Header="Bemerkungen" DisplayMemberBinding="{Binding Bemerkung}" Width="80"/>
                    </GridView>
                </ListView.View>
            </ListView>
        </StackPanel>

        <TabControl Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="5">
            <TabItem Header="Strecke">
                <Grid>
                    <ScrollViewer Name="SV_Strecke" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                        <Canvas Name="Canvas_Strecke" MinWidth="500" MinHeight="200" Background="AliceBlue"
                                MouseWheel="Canvas_Strecke_MouseWheel" MouseDown="Canvas_Strecke_MouseDown" MouseMove="Canvas_Strecke_MouseMove" MouseUp="Canvas_Strecke_MouseUp">
                            <Canvas.RenderTransform>
                                <TransformGroup>
                                    <ScaleTransform x:Name="StreckeScale" ScaleX="1" ScaleY="1"/>
                                    <TranslateTransform x:Name="StreckeTranslate" X="0" Y="0"/>
                                </TransformGroup>
                            </Canvas.RenderTransform>
                        </Canvas>
                    </ScrollViewer>
                </Grid>
            </TabItem>
            <TabItem Header="Fahrtverlauf">
                <Canvas Name="Canvas_Fahrtverlauf" MinWidth="500" MinHeight="200" Background="AliceBlue"></Canvas>
            </TabItem>
            <TabItem Header="XLS>XML" Name="TabXLS" Visibility="{Binding EditElements}" >
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <TextBox Name="TB_XLS_Input" Grid.Row="0" TextChanged="TB_XLS_Input_TextChanged" AcceptsReturn="True" AcceptsTab="True"/>
                    <StackPanel Grid.Row="1" Orientation="Horizontal">
                        <TextBlock Text="Streckennummer:" Margin="5,2,0,0"/>
                       <TextBox Name="TB_XLS_Streckennummer" Grid.Row="1" Width="100"/>
                        <TextBlock Text="Startindex:" Margin="5,2,0,0"/>
                        <TextBox Name="TB_XLS_Startindex" Grid.Row="1" Width="100"/>
                    </StackPanel>
                    
                    <TextBox Name="TB_XML_Output" Grid.Row="2" AcceptsReturn="True" AcceptsTab="True"/> 
                </Grid>
            </TabItem>
            <TabItem Header="Editor" Visibility="{Binding EditElements}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <DataGrid x:Name="DG_Bremswegeintraege"
          ItemsSource="{Binding Listata, Mode=TwoWay}"
          AutoGenerateColumns="True"
          Margin="10"
          IsReadOnly="False"
          CanUserAddRows="True"
          CanUserDeleteRows="True"
          Height="300" />

                    <Button Content="XML speichern"  Grid.Row="1"      Margin="10"        Click="BTN_XML_Speichern_Click" />
                </Grid>
            </TabItem>
        </TabControl>
       <StatusBar Name="SB_Status" Grid.Row="4" Grid.RowSpan="5" >
            <CheckBox Content="Editiermodus" Name="CB_EditModus" IsEnabled="False"/>
            <TextBlock Text="???" Margin="10,10,0,0" Foreground="Red" FontWeight="Bold" Name="TBHinweis"/>
           
        </StatusBar>  
    </Grid>
   
</Window>
